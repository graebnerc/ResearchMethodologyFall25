<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Claudius Gr√§bner-Radkowitsch">

<title>Linear regression: residuals and model diagnostics ‚Äì Theoretical and Empirical Research Methodology - Implementation Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../figures/icons/course_favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-7ed03afd9cad4b9a490e112b22b8940a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Linear regression: residuals and model diagnostics ‚Äì Theoretical and Empirical Research Methodology - Implementation Lab">
<meta property="og:description" content="">
<meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="Theoretical and Empirical Research Methodology - Implementation Lab">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Theoretical and Empirical Research Methodology - Implementation Lab</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Linear regression: residuals and model diagnostics</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üè† Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üè¢ Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">üóìÔ∏è Material</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session08b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/material/session10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 10</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üëæ Additional exercises</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/statrecap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üìà Statistics recap</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#understanding-residuals-the-foundation-of-diagnostics" id="toc-understanding-residuals-the-foundation-of-diagnostics" class="nav-link active" data-scroll-target="#understanding-residuals-the-foundation-of-diagnostics">Understanding Residuals: The Foundation of Diagnostics</a>
  <ul class="collapse">
  <li><a href="#what-are-residuals" id="toc-what-are-residuals" class="nav-link" data-scroll-target="#what-are-residuals">What Are Residuals?</a></li>
  <li><a href="#residuals-vs.-error-terms-a-critical-distinction" id="toc-residuals-vs.-error-terms-a-critical-distinction" class="nav-link" data-scroll-target="#residuals-vs.-error-terms-a-critical-distinction">Residuals vs.&nbsp;Error Terms: A Critical Distinction</a></li>
  <li><a href="#why-this-distinction-matters" id="toc-why-this-distinction-matters" class="nav-link" data-scroll-target="#why-this-distinction-matters">Why This Distinction Matters</a></li>
  <li><a href="#types-of-residuals-in-diagnostics" id="toc-types-of-residuals-in-diagnostics" class="nav-link" data-scroll-target="#types-of-residuals-in-diagnostics">Types of Residuals in Diagnostics</a></li>
  <li><a href="#why-residuals-are-central-to-diagnostics" id="toc-why-residuals-are-central-to-diagnostics" class="nav-link" data-scroll-target="#why-residuals-are-central-to-diagnostics">Why Residuals Are Central to Diagnostics</a></li>
  <li><a href="#the-diagnostic-philosophy" id="toc-the-diagnostic-philosophy" class="nav-link" data-scroll-target="#the-diagnostic-philosophy">The Diagnostic Philosophy</a></li>
  <li><a href="#a-practical-example" id="toc-a-practical-example" class="nav-link" data-scroll-target="#a-practical-example">A Practical Example</a></li>
  </ul></li>
  <li><a href="#understanding-the-assumptions" id="toc-understanding-the-assumptions" class="nav-link" data-scroll-target="#understanding-the-assumptions">Understanding the Assumptions</a>
  <ul class="collapse">
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity">1. Linearity</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence">2. Independence</a></li>
  <li><a href="#homoscedasticity" id="toc-homoscedasticity" class="nav-link" data-scroll-target="#homoscedasticity">3. Homoscedasticity</a></li>
  <li><a href="#normality" id="toc-normality" class="nav-link" data-scroll-target="#normality">4. Normality</a></li>
  </ul></li>
  <li><a href="#summary-table-of-assumptions-and-tests" id="toc-summary-table-of-assumptions-and-tests" class="nav-link" data-scroll-target="#summary-table-of-assumptions-and-tests">Summary Table of Assumptions and Tests</a></li>
  <li><a href="#essential-visual-diagnostic-tests" id="toc-essential-visual-diagnostic-tests" class="nav-link" data-scroll-target="#essential-visual-diagnostic-tests">Essential Visual Diagnostic Tests</a>
  <ul class="collapse">
  <li><a href="#the-four-standard-diagnostic-plots" id="toc-the-four-standard-diagnostic-plots" class="nav-link" data-scroll-target="#the-four-standard-diagnostic-plots">The Four Standard Diagnostic Plots</a></li>
  </ul></li>
  <li><a href="#quantitative-diagnostic-tests-optional" id="toc-quantitative-diagnostic-tests-optional" class="nav-link" data-scroll-target="#quantitative-diagnostic-tests-optional">Quantitative Diagnostic Tests (Optional)</a>
  <ul class="collapse">
  <li><a href="#tests-for-normality" id="toc-tests-for-normality" class="nav-link" data-scroll-target="#tests-for-normality">Tests for Normality</a></li>
  <li><a href="#tests-for-homoscedasticity" id="toc-tests-for-homoscedasticity" class="nav-link" data-scroll-target="#tests-for-homoscedasticity">Tests for Homoscedasticity</a></li>
  <li><a href="#test-for-independence" id="toc-test-for-independence" class="nav-link" data-scroll-target="#test-for-independence">Test for Independence</a></li>
  <li><a href="#test-for-linearity" id="toc-test-for-linearity" class="nav-link" data-scroll-target="#test-for-linearity">Test for Linearity</a></li>
  <li><a href="#tests-for-multicollinearity" id="toc-tests-for-multicollinearity" class="nav-link" data-scroll-target="#tests-for-multicollinearity">Tests for Multicollinearity</a></li>
  <li><a href="#tests-for-influential-observations" id="toc-tests-for-influential-observations" class="nav-link" data-scroll-target="#tests-for-influential-observations">Tests for Influential Observations</a></li>
  </ul></li>
  <li><a href="#practical-workflow-for-diagnostics" id="toc-practical-workflow-for-diagnostics" class="nav-link" data-scroll-target="#practical-workflow-for-diagnostics">Practical Workflow for Diagnostics</a>
  <ul class="collapse">
  <li><a href="#always-start-with-visual-diagnostics" id="toc-always-start-with-visual-diagnostics" class="nav-link" data-scroll-target="#always-start-with-visual-diagnostics">1. Always Start with Visual Diagnostics</a></li>
  <li><a href="#run-key-quantitative-tests-optional" id="toc-run-key-quantitative-tests-optional" class="nav-link" data-scroll-target="#run-key-quantitative-tests-optional">2. Run Key Quantitative Tests (Optional)</a></li>
  <li><a href="#investigate-issues-identified" id="toc-investigate-issues-identified" class="nav-link" data-scroll-target="#investigate-issues-identified">3. Investigate Issues Identified</a></li>
  <li><a href="#additional-tests-when-needed" id="toc-additional-tests-when-needed" class="nav-link" data-scroll-target="#additional-tests-when-needed">4. Additional Tests When Needed</a></li>
  </ul></li>
  <li><a href="#key-principles-to-remember" id="toc-key-principles-to-remember" class="nav-link" data-scroll-target="#key-principles-to-remember">Key Principles to Remember</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="regression_diagnostics_revised.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Linear regression: residuals and model diagnostics</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://claudius-graebner.com/">Claudius Gr√§bner-Radkowitsch</a> <a href="https://orcid.org/0000-0003-4065-4722" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.uni-flensburg.de/en/pluralist-economics">
            EUF and JKU
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">08 12 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>R Packages Used</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="understanding-residuals-the-foundation-of-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="understanding-residuals-the-foundation-of-diagnostics">Understanding Residuals: The Foundation of Diagnostics</h2>
<p>Before diving into assumptions and diagnostic tests, we need to understand residuals‚Äîthe cornerstone of all regression diagnostics. Many students confuse residuals with error terms, but understanding the distinction is crucial for interpreting diagnostic plots and tests.</p>
<section id="what-are-residuals" class="level3">
<h3 class="anchored" data-anchor-id="what-are-residuals">What Are Residuals?</h3>
<p><strong>Residuals</strong> are the observed differences between actual values and predicted values from your fitted model:</p>
<p><span class="math display">\[e_i = y_i - \hat{y}_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(e_i\)</span> is the residual for observation <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(y_i\)</span> is the actual observed value</li>
<li><span class="math inline">\(\hat{y}_i\)</span> is the predicted value from your regression model</li>
</ul>
<p><strong>In plain language:</strong> A residual tells you how far off your prediction was for each observation. If your model predicts a customer will spend 100 EUR but they actually spent 120 EUR, the residual is 20 EUR (see also <a href="#fig-residuals" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-residuals" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="residuals_plot.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Illustration of a residual.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-vs.-error-terms-a-critical-distinction" class="level3">
<h3 class="anchored" data-anchor-id="residuals-vs.-error-terms-a-critical-distinction">Residuals vs.&nbsp;Error Terms: A Critical Distinction</h3>
<p>Students often use ‚Äúresidual‚Äù and ‚Äúerror‚Äù interchangeably, but they are fundamentally different concepts:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Symbol</th>
<th>What It Is</th>
<th>Can We Observe It?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Error term</strong></td>
<td><span class="math inline">\(\epsilon_i\)</span></td>
<td>True, unknown deviation from the population regression line</td>
<td><strong>No</strong> - it‚Äôs a theoretical concept</td>
</tr>
<tr class="even">
<td><strong>Residual</strong></td>
<td><span class="math inline">\(e_i\)</span></td>
<td>Observed deviation from our fitted sample regression line</td>
<td><strong>Yes</strong> - we calculate it from our data</td>
</tr>
</tbody>
</table>
<p><strong>The error term</strong> (<span class="math inline">\(\epsilon_i\)</span>) is the true, unobservable deviation in the population model:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p>This represents the ‚Äútrue‚Äù relationship in the population. We never observe <span class="math inline">\(\epsilon_i\)</span> because we don‚Äôt know the true population parameters (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>).</p>
<p><strong>The residual</strong> (<span class="math inline">\(e_i\)</span>) is what we actually observe from our fitted sample model:</p>
<p><span class="math display">\[y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + e_i\]</span></p>
<p>This is our estimate based on sample data. We calculate <span class="math inline">\(e_i\)</span> because we have estimates <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
</section>
<section id="why-this-distinction-matters" class="level3">
<h3 class="anchored" data-anchor-id="why-this-distinction-matters">Why This Distinction Matters</h3>
<ol type="1">
<li><p><strong>Assumptions are about error terms, not residuals:</strong> When we say ‚Äúerrors are normally distributed‚Äù or ‚Äúerrors have constant variance,‚Äù we‚Äôre making statements about the unobservable <span class="math inline">\(\epsilon_i\)</span> in the population.</p></li>
<li><p><strong>Diagnostics use residuals to learn about errors:</strong> Since we can‚Äôt observe <span class="math inline">\(\epsilon_i\)</span>, we use residuals <span class="math inline">\(e_i\)</span> as our best approximation. We examine residuals hoping they reveal the properties of the true errors.</p></li>
<li><p><strong>Residuals are estimates of errors:</strong> Under the regression assumptions, residuals should behave similarly to errors. If they don‚Äôt (showing patterns, non-constant variance, etc.), it suggests the assumptions are violated.</p></li>
</ol>
</section>
<section id="types-of-residuals-in-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="types-of-residuals-in-diagnostics">Types of Residuals in Diagnostics</h3>
<p>You‚Äôll encounter several types of residuals in diagnostic output:</p>
<p><strong>1. Raw residuals</strong> (<span class="math inline">\(e_i\)</span>): <span class="math display">\[e_i = y_i - \hat{y}_i\]</span></p>
<p>These are what we‚Äôve been discussing‚Äîthe basic difference between observed and predicted values.</p>
<p><strong>2. Standardized residuals</strong> (<span class="math inline">\(e_i^*\)</span>): <span class="math display">\[e_i^* = \frac{e_i}{\hat{\sigma}\sqrt{1-h_i}}\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}\)</span> is the residual standard error and <span class="math inline">\(h_i\)</span> is the leverage. Standardized residuals have approximately unit variance, making them comparable across observations. Values beyond ¬±2 or ¬±3 suggest potential outliers.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Understanding Leverage
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Leverage</strong> (denoted as <span class="math inline">\(h_i\)</span> or ‚Äúhat value‚Äù) measures how unusual or extreme an observation‚Äôs predictor values (X values) are compared to the rest of the data. It quantifies how far an observation is from the center of the predictor space.</p>
<p><strong>Mathematical definition:</strong></p>
<p>In simple linear regression, leverage for observation <span class="math inline">\(i\)</span> is:</p>
<p><span class="math display">\[h_i = \frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{j=1}^{n}(x_j - \bar{x})^2}\]</span></p>
<p>In multiple regression, leverage values come from the diagonal of the ‚Äúhat matrix‚Äù <span class="math inline">\(\mathbf{H} = \mathbf{X}(\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\)</span>, which ‚Äúputs the hat‚Äù on <span class="math inline">\(\mathbf{y}\)</span> to get <span class="math inline">\(\hat{\mathbf{y}}\)</span>.</p>
<p><strong>Key properties:</strong></p>
<ul>
<li>Leverage ranges from <span class="math inline">\(\frac{1}{n}\)</span> to 1</li>
<li>Average leverage is <span class="math inline">\(\frac{p}{n}\)</span> where <span class="math inline">\(p\)</span> is the number of parameters (including intercept)</li>
<li>Sum of all leverage values equals <span class="math inline">\(p\)</span>: <span class="math inline">\(\sum_{i=1}^{n} h_i = p\)</span></li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Low leverage</strong> (<span class="math inline">\(h_i \approx \frac{p}{n}\)</span>): The observation‚Äôs X values are typical, close to the center of the data</li>
<li><strong>High leverage</strong> (<span class="math inline">\(h_i &gt; \frac{2p}{n}\)</span> or <span class="math inline">\(\frac{3p}{n}\)</span>): The observation‚Äôs X values are unusual or extreme</li>
</ul>
<p><strong>Why leverage matters:</strong></p>
<p>High leverage observations have greater potential to influence the regression line because they‚Äôre far from the center of the data. Think of a lever: observations far from the fulcrum (center) have more power to move the line.</p>
<p>However, <strong>high leverage alone doesn‚Äôt make a point influential</strong>:</p>
<ul>
<li>If a high leverage point fits the model well (small residual), it reinforces the pattern and isn‚Äôt problematic</li>
<li>If a high leverage point doesn‚Äôt fit the model (large residual), it can dramatically pull the regression line toward itself</li>
</ul>
<p><strong>Example:</strong></p>
<p>Imagine studying the relationship between study hours and exam scores for students who studied 10-20 hours. A student who studied 40 hours would have high leverage‚Äîthey‚Äôre far from the typical range. If they score as predicted by the pattern, they confirm it. If they score much lower or higher than expected, they could dramatically change your estimated relationship.</p>
<p><strong>Why leverage appears in standardized residuals:</strong></p>
<p>The formula <span class="math inline">\(e_i^* = \frac{e_i}{\hat{\sigma}\sqrt{1-h_i}}\)</span> adjusts for the fact that observations with high leverage naturally have smaller residuals because the regression line is ‚Äúpulled‚Äù toward them. Without this adjustment, high leverage points would appear to fit better than they actually do, masking potential problems.</p>
</div>
</div>
</div>
<p><strong>3. Studentized residuals:</strong></p>
<p>Similar to standardized but use a different estimate of variance that excludes observation <span class="math inline">\(i\)</span>. More robust for identifying outliers.</p>
<p><strong>Why standardize?</strong> Raw residuals naturally have different variances depending on the leverage of each observation. Standardization accounts for this, putting all residuals on the same scale for fair comparison.</p>
</section>
<section id="why-residuals-are-central-to-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="why-residuals-are-central-to-diagnostics">Why Residuals Are Central to Diagnostics</h3>
<p>Residuals are the empirical manifestation of all our modeling assumptions. Here‚Äôs why they‚Äôre so important:</p>
<p><strong>1. They reveal assumption violations:</strong></p>
<ul>
<li><strong>Linearity:</strong> If the relationship isn‚Äôt linear, residuals will show systematic patterns (curves, waves)</li>
<li><strong>Homoscedasticity:</strong> If variance isn‚Äôt constant, residuals will spread out (or contract) across fitted values</li>
<li><strong>Normality:</strong> If errors aren‚Äôt normal, the distribution of residuals will deviate from normality</li>
<li><strong>Independence:</strong> If observations aren‚Äôt independent, residuals will show autocorrelation or clustering</li>
</ul>
<p><strong>2. They‚Äôre model-free diagnostics:</strong></p>
<p>Residuals don‚Äôt require you to know the ‚Äútrue‚Äù model. They simply show you what‚Äôs left unexplained after fitting your model. Large, systematic patterns in residuals mean your model is missing something important.</p>
<p><strong>3. They provide a common framework:</strong></p>
<p>Almost every diagnostic tool examines residuals in some way:</p>
<ul>
<li>Plotting residuals to check for patterns</li>
<li>Testing the distribution of residuals</li>
<li>Examining residual variance across groups</li>
<li>Identifying observations with unusual residuals</li>
</ul>
<p><strong>4. They quantify model performance:</strong></p>
<p>The magnitude of residuals tells you about prediction accuracy. Ideally, residuals should be:</p>
<ul>
<li>Small in magnitude (good predictions)</li>
<li>Random in pattern (no systematic errors)</li>
<li>Homogeneous in variance (consistent precision)</li>
<li>Approximately normal (valid inference)</li>
</ul>
</section>
<section id="the-diagnostic-philosophy" class="level3">
<h3 class="anchored" data-anchor-id="the-diagnostic-philosophy">The Diagnostic Philosophy</h3>
<p>When you examine diagnostic plots, you‚Äôre asking: <strong>‚ÄúDo these residuals behave like random noise, or do they show systematic patterns that suggest model problems?‚Äù</strong></p>
<p>If residuals are truly random (as they should be when assumptions hold), they should:</p>
<ul>
<li>Scatter randomly around zero with no patterns</li>
<li>Have roughly constant spread across all fitted values</li>
<li>Follow a normal distribution (for the population errors)</li>
<li>Show no relationship to predictor variables, fitted values, or observation order</li>
</ul>
<p>Any deviation from this ideal suggests where your model or assumptions may be failing.</p>
</section>
<section id="a-practical-example" class="level3">
<h3 class="anchored" data-anchor-id="a-practical-example">A Practical Example</h3>
<p>Imagine you‚Äôre modeling house prices based on square footage:</p>
<ul>
<li><strong>Model:</strong> Price = $50,000 + $200 √ó SqFt</li>
<li><strong>Observation:</strong> A 1,500 sq ft house sells for $350,000</li>
<li><strong>Prediction:</strong> <span class="math inline">\(\hat{y}\)</span> = $50,000 + $200 √ó 1,500 = $350,000</li>
<li><strong>Residual:</strong> <span class="math inline">\(e\)</span> = $350,000 - $350,000 = $0 (perfect prediction!)</li>
</ul>
<p>But for another house:</p>
<ul>
<li><strong>Observation:</strong> A 2,000 sq ft house sells for $500,000</li>
<li><strong>Prediction:</strong> <span class="math inline">\(\hat{y}\)</span> = $50,000 + $200 √ó 2,000 = $450,000</li>
<li><strong>Residual:</strong> <span class="math inline">\(e\)</span> = $500,000 - $450,000 = $50,000 (underpredicted by $50,000)</li>
</ul>
<p>If most large houses have large positive residuals, this pattern suggests your linear model is inadequate‚Äîperhaps you need a quadratic term or the relationship changes at higher square footage.</p>
<hr>
</section>
</section>
<section id="understanding-the-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-assumptions">Understanding the Assumptions</h2>
<p>Linear regression relies on four key assumptions about the data and the relationship between variables. Understanding these assumptions is crucial because violations can lead to:</p>
<ul>
<li><strong>Biased parameter estimates</strong> (incorrect coefficients)</li>
<li><strong>Invalid standard errors</strong> (unreliable confidence intervals)</li>
<li><strong>Incorrect hypothesis tests</strong> (wrong p-values and conclusions)</li>
<li><strong>Poor predictions</strong> (inaccurate forecasts)</li>
</ul>
<section id="linearity" class="level3">
<h3 class="anchored" data-anchor-id="linearity">1. Linearity</h3>
<p><strong>What it means:</strong> The relationship between each predictor variable and the outcome variable is linear. In mathematical terms, the conditional expectation of Y given X follows a linear function: <span class="math inline">\(E[Y|X] = \beta_0 + \beta_1 X_1 + ... + \beta_p X_p\)</span></p>
<p><strong>Why it matters:</strong> Linear regression models can only capture linear relationships. If the true relationship is curved or more complex, the model will systematically mispredict values, leading to biased estimates and poor fit.</p>
<p><strong>What happens if violated:</strong> The model will show systematic patterns in residuals (curves, waves), predictions will be systematically wrong in certain ranges, and R¬≤ will underestimate the true strength of the relationship.</p>
</section>
<section id="independence" class="level3">
<h3 class="anchored" data-anchor-id="independence">2. Independence</h3>
<p><strong>What it means:</strong> Each observation is independent of all other observations. The residual (error) for one observation does not depend on the residual for any other observation: <span class="math inline">\(Cov(\epsilon_i, \epsilon_j) = 0\)</span> for <span class="math inline">\(i \neq j\)</span>.</p>
<p><strong>Why it matters:</strong> Independence is required for valid standard errors and hypothesis tests. When observations are correlated (e.g., repeated measurements from the same person, or time series data), standard errors are typically underestimated, leading to overconfident conclusions.</p>
<p><strong>What happens if violated:</strong> Standard errors are incorrect (usually too small), confidence intervals are too narrow, p-values are too small (Type I error inflation), and you may falsely conclude that relationships are significant.</p>
<p><strong>Common violations:</strong> Time series data (autocorrelation), clustered data (students within schools), repeated measures (multiple observations per subject), spatial data (nearby locations are similar).</p>
</section>
<section id="homoscedasticity" class="level3">
<h3 class="anchored" data-anchor-id="homoscedasticity">3. Homoscedasticity</h3>
<p><strong>What it means:</strong> The variance of the residuals is constant across all levels of the predictor variables: <span class="math inline">\(Var(\epsilon_i) = \sigma^2\)</span> for all <span class="math inline">\(i\)</span>. The ‚Äúspread‚Äù of residuals should be the same whether you‚Äôre predicting low or high values.</p>
<p><strong>Why it matters:</strong> Heteroscedasticity (non-constant variance) leads to inefficient estimates and incorrect standard errors. While coefficient estimates remain unbiased, hypothesis tests and confidence intervals become unreliable.</p>
<p><strong>What happens if violated:</strong> Standard errors are incorrect, confidence intervals are wrong (may be too wide or too narrow), hypothesis tests are invalid, and the model is inefficient (there are better ways to estimate the relationships).</p>
<p><strong>Common causes:</strong> The variance of Y naturally increases with X (e.g., spending variance increases with income), measurement error that varies, or misspecified functional form (wrong model).</p>
</section>
<section id="normality" class="level3">
<h3 class="anchored" data-anchor-id="normality">4. Normality</h3>
<p><strong>What it means:</strong> The residuals (errors) follow a normal distribution: <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>. Note that this assumption is about the residuals, not the variables themselves.</p>
<p><strong>Why it matters:</strong> Normality is primarily required for valid hypothesis tests and confidence intervals, especially in small samples. The Central Limit Theorem helps here: with large samples (n &gt; 30-50), inference remains approximately valid even with moderate departures from normality.</p>
<p><strong>What happens if violated:</strong> Confidence intervals and hypothesis tests may be inaccurate, especially in small samples. Predictions and coefficient estimates remain unbiased, but uncertainty quantification becomes unreliable.</p>
<p><strong>Important note:</strong> This is the least critical assumption for large samples due to the Central Limit Theorem. Focus more on linearity, independence, and homoscedasticity.</p>
<hr>
</section>
</section>
<section id="summary-table-of-assumptions-and-tests" class="level2">
<h2 class="anchored" data-anchor-id="summary-table-of-assumptions-and-tests">Summary Table of Assumptions and Tests</h2>
<div id="tbl-assumptions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-assumptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary of linear regression assumptions and diagnostic approaches
</figcaption>
<div aria-describedby="tbl-assumptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Description</th>
<th>Visual Test</th>
<th>Quantitative Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Linearity</strong></td>
<td>The relationship between predictors and outcome is linear</td>
<td>Residuals vs Fitted plot (Tukey-Anscombe)</td>
<td>RESET test (Ramsey)</td>
</tr>
<tr class="even">
<td><strong>Independence</strong></td>
<td>Observations are independent of each other</td>
<td>Residuals vs Order plot; ACF plot</td>
<td>Durbin-Watson test</td>
</tr>
<tr class="odd">
<td><strong>Homoscedasticity</strong></td>
<td>Constant variance of residuals across all levels of predictors</td>
<td>Residuals vs Fitted; Scale-Location plot</td>
<td>Breusch-Pagan test; White test</td>
</tr>
<tr class="even">
<td><strong>Normality</strong></td>
<td>Residuals follow a normal distribution</td>
<td>QQ plot; Histogram of residuals</td>
<td>Shapiro-Wilk test; Kolmogorov-Smirnov test</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<hr>
</section>
<section id="essential-visual-diagnostic-tests" class="level2">
<h2 class="anchored" data-anchor-id="essential-visual-diagnostic-tests">Essential Visual Diagnostic Tests</h2>
<p>Visual diagnostics are your first and most important line of defense. R automatically generates four diagnostic plots with <code>plot(lm_model)</code> that provide a comprehensive visual assessment. Always examine these plots before moving to quantitative tests.</p>
<section id="the-four-standard-diagnostic-plots" class="level3">
<h3 class="anchored" data-anchor-id="the-four-standard-diagnostic-plots">The Four Standard Diagnostic Plots</h3>
<section id="plot-1-residuals-vs-fitted-tukey-anscombe-plot" class="level4">
<h4 class="anchored" data-anchor-id="plot-1-residuals-vs-fitted-tukey-anscombe-plot">Plot 1: Residuals vs Fitted (Tukey-Anscombe Plot)</h4>
<p><strong>Purpose:</strong> Checks linearity and homoscedasticity simultaneously.</p>
<p><strong>How it works:</strong> Plots residuals (<span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>) against fitted values (<span class="math inline">\(\hat{y}_i\)</span>). If the linearity and homoscedasticity assumptions hold, residuals should be randomly scattered around zero with no patterns or trends.</p>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Good:</strong> Random scatter around the horizontal line at zero, with no discernible pattern (see <a href="#fig-residfit-good" class="quarto-xref">Figure&nbsp;2</a>)</li>
<li><strong>Problem - Non-linearity:</strong> Curved pattern (U-shape, inverted U, or other systematic curves) indicates the relationship is not linear (see <a href="#fig-residfit-nonlinear" class="quarto-xref">Figure&nbsp;3</a>)</li>
<li><strong>Problem - Heteroscedasticity:</strong> Funnel shape (expanding or contracting spread) indicates non-constant variance (see <a href="#fig-residfit-hetero" class="quarto-xref">Figure&nbsp;4</a>)</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-residfit-good" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residfit-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-residfit-good-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residfit-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Residuals vs Fitted plot showing a good model fit. Residuals are randomly scattered around zero with no patterns, indicating linearity and homoscedasticity are satisfied.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-residfit-nonlinear" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residfit-nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-residfit-nonlinear-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residfit-nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Residuals vs Fitted plot showing a non-linear relationship. The curved pattern in the residuals indicates that a linear model is inadequate and transformations or polynomial terms may be needed.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-residfit-hetero" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residfit-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-residfit-hetero-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residfit-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Residuals vs Fitted plot showing heteroscedasticity. The funnel shape (increasing spread of residuals) indicates that variance is not constant across the range of fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> The smoothed line (blue) should be approximately horizontal at zero. Any systematic deviation indicates assumption violations.</p>
<hr>
</section>
<section id="plot-2-normal-q-q-plot" class="level4">
<h4 class="anchored" data-anchor-id="plot-2-normal-q-q-plot">Plot 2: Normal Q-Q Plot</h4>
<p><strong>Purpose:</strong> Checks whether residuals follow a normal distribution.</p>
<p><strong>How it works:</strong> Plots the quantiles of standardized residuals against theoretical quantiles from a standard normal distribution. If residuals are normally distributed, points should fall along the diagonal reference line.</p>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Good:</strong> Points closely follow the diagonal line from lower-left to upper-right (see <a href="#fig-qq-good" class="quarto-xref">Figure&nbsp;5</a>)</li>
<li><strong>Problem - Heavy tails:</strong> Points deviate from the line at both extremes, curving away (see <a href="#fig-qq-nonnormal" class="quarto-xref">Figure&nbsp;6</a>)</li>
<li><strong>Problem - Skewness:</strong> Points deviate systematically in one direction, showing an S-curve</li>
<li><strong>Problem - Light tails:</strong> Points deviate toward the line at extremes</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-qq-good" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qq-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-qq-good-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qq-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Normal Q-Q plot showing normally distributed residuals. Points fall closely along the diagonal reference line, indicating the normality assumption is satisfied.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-qq-nonnormal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qq-nonnormal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-qq-nonnormal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qq-nonnormal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Normal Q-Q plot showing non-normally distributed residuals. The systematic deviation from the diagonal line (particularly in the tails) indicates a violation of the normality assumption.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Minor deviations are often acceptable, especially with larger sample sizes (n &gt; 30-50) where the Central Limit Theorem provides robustness. Focus on gross departures from normality rather than minor wiggles.</p>
<hr>
</section>
<section id="plot-3-scale-location-plot" class="level4">
<h4 class="anchored" data-anchor-id="plot-3-scale-location-plot">Plot 3: Scale-Location Plot</h4>
<p><strong>Purpose:</strong> Checks homoscedasticity more clearly than the Residuals vs Fitted plot.</p>
<p><strong>How it works:</strong> Plots the square root of standardized residuals (<span class="math inline">\(\sqrt{|e_i^*|}\)</span>) against fitted values. The square root transformation stabilizes variance and makes patterns of heteroscedasticity easier to detect.</p>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Good:</strong> Roughly horizontal smoothed line with points evenly spread around it (see <a href="#fig-scale-good" class="quarto-xref">Figure&nbsp;7</a>)</li>
<li><strong>Problem:</strong> Smoothed line has a clear trend (upward or downward slope), or the spread of points increases/decreases systematically (see <a href="#fig-scale-hetero" class="quarto-xref">Figure&nbsp;8</a>)</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scale-good" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scale-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-scale-good-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scale-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Scale-Location plot showing homoscedasticity. The smoothed line is approximately horizontal and the spread of points is roughly constant, indicating constant variance of residuals.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scale-hetero" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scale-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-scale-hetero-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scale-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Scale-Location plot showing heteroscedasticity. The upward trend in the smoothed line indicates increasing variance of residuals as fitted values increase.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> This plot makes heteroscedasticity violations more apparent than the standard Residuals vs Fitted plot because the square root transformation amplifies patterns in variance.</p>
<hr>
</section>
<section id="plot-4-residuals-vs-leverage" class="level4">
<h4 class="anchored" data-anchor-id="plot-4-residuals-vs-leverage">Plot 4: Residuals vs Leverage</h4>
<p><strong>Purpose:</strong> Identifies influential observations that disproportionately affect the regression model.</p>
<p><strong>How it works:</strong> Plots standardized residuals against leverage (hat values). Includes Cook‚Äôs distance contours to identify problematic points that are both unusual in their predictor values (high leverage) and poorly predicted by the model (large residuals).</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Understanding Cook‚Äôs Distance and Contours
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Cook‚Äôs Distance</strong> measures the influence of each observation on the fitted values. It quantifies how much all fitted values change when observation <span class="math inline">\(i\)</span> is deleted from the analysis:</p>
<p><span class="math display">\[D_i = \frac{\sum_{j=1}^{n}(\hat{y}_j - \hat{y}_{j(i)})^2}{p \cdot MSE}\]</span></p>
<p>where <span class="math inline">\(\hat{y}_{j(i)}\)</span> is the predicted value for observation <span class="math inline">\(j\)</span> when observation <span class="math inline">\(i\)</span> is excluded, <span class="math inline">\(p\)</span> is the number of parameters, and <span class="math inline">\(MSE\)</span> is the mean squared error.</p>
<p>Alternatively, Cook‚Äôs distance combines leverage and residual size:</p>
<p><span class="math display">\[D_i = \frac{(e_i^*)^2}{p} \times \frac{h_i}{1-h_i}\]</span></p>
<p>where <span class="math inline">\(e_i^*\)</span> is the standardized residual and <span class="math inline">\(h_i\)</span> is the leverage (hat value).</p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(D_i &gt; 0.5\)</span>: Investigate this observation carefully</li>
<li><span class="math inline">\(D_i &gt; 1.0\)</span>: This observation is highly influential and seriously affects your results</li>
</ul>
<p><strong>Contours on the plot:</strong></p>
<p>The dashed curves on the Residuals vs Leverage plot show Cook‚Äôs distance contours (typically at 0.5 and 1.0). Points that fall outside these contours have high influence.</p>
<p><strong>What makes a point influential?</strong></p>
<p>Two factors contribute to influence:</p>
<ol type="1">
<li><strong>Leverage (<span class="math inline">\(h_i\)</span>)</strong>: How unusual the predictor values are. High leverage means the X values are far from the mean.</li>
<li><strong>Residual size</strong>: How poorly the model predicts this observation.</li>
</ol>
<p>A point needs BOTH high leverage AND a large residual to be truly influential. High leverage alone (if well-predicted) or large residuals alone (if typical X values) are less concerning.</p>
<p><strong>What to do about influential points:</strong></p>
<ol type="1">
<li>Check for data entry errors</li>
<li>Determine if the point represents a different population</li>
<li>Investigate whether the point provides important information or is an anomaly</li>
<li>Consider reporting results both with and without influential observations</li>
<li>Never automatically delete influential points - understand why they‚Äôre influential first</li>
</ol>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-leverage-good" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leverage-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-leverage-good-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leverage-good-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Residuals vs Leverage plot for a well-behaved model. All points fall well within Cook‚Äôs distance contours (dashed red lines at 0.5 and 1.0), with no concerning leverage or Cook‚Äôs distance values.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-leverage-problem" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leverage-problem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_diagnostics_revised_files/figure-html/fig-leverage-problem-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leverage-problem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Residuals vs Leverage plot showing influential observations. Several points (shown with larger symbols) have high Cook‚Äôs distance values and fall outside or near the contours. The dashed red lines show Cook‚Äôs distance contours at 0.5 and 1.0. Points outside these contours, especially in the corners (high leverage AND large residuals), are particularly concerning.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Good:</strong> All points have moderate leverage and standardized residuals, with small Cook‚Äôs distance values (see <a href="#fig-leverage-good" class="quarto-xref">Figure&nbsp;9</a>)</li>
<li><strong>Problem:</strong> Points in the corners (high leverage AND large residuals) with large Cook‚Äôs distance values (see <a href="#fig-leverage-problem" class="quarto-xref">Figure&nbsp;10</a>)</li>
</ul>
<p><strong>Key concepts:</strong></p>
<ul>
<li><strong>Leverage (<span class="math inline">\(h_i\)</span>):</strong> Measures how far an observation‚Äôs predictor values are from the mean of the predictors. Average leverage is <span class="math inline">\(p/n\)</span> where <span class="math inline">\(p\)</span> is the number of parameters.</li>
<li><strong>High leverage:</strong> Points with <span class="math inline">\(h_i &gt; 2p/n\)</span> or <span class="math inline">\(h_i &gt; 3p/n\)</span></li>
<li><strong>Influential:</strong> High leverage AND large residual, indicated by large Cook‚Äôs distance</li>
</ul>
<p><strong>Important note on outliers vs.&nbsp;influential points:</strong></p>
<ul>
<li><strong>Outliers</strong> have unusual Y values (large residuals) but may not be influential if they have typical X values</li>
<li><strong>High leverage points</strong> have unusual X values but may not be influential if well-predicted</li>
<li><strong>Influential points</strong> combine both: unusual X values (high leverage) AND large residuals</li>
</ul>
<p>This fourth diagnostic plot specifically helps identify influential observations that warrant investigation, even though ‚Äúno influential outliers‚Äù is not a formal statistical assumption of linear regression.</p>
<hr>
</section>
</section>
</section>
<section id="quantitative-diagnostic-tests-optional" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-diagnostic-tests-optional">Quantitative Diagnostic Tests (Optional)</h2>
<p>While visual diagnostics should always be your primary tool, quantitative tests can provide additional confirmation and are useful when you need to report formal test results. However, be aware that these tests can be overly sensitive in large samples, detecting trivial violations that don‚Äôt meaningfully affect your results.</p>
<section id="tests-for-normality" class="level3">
<h3 class="anchored" data-anchor-id="tests-for-normality">Tests for Normality</h3>
<section id="shapiro-wilk-test" class="level4">
<h4 class="anchored" data-anchor-id="shapiro-wilk-test">Shapiro-Wilk Test</h4>
<p><strong>Purpose:</strong> Formal test of whether residuals follow a normal distribution.</p>
<p><strong>How it works:</strong> Tests the null hypothesis <span class="math inline">\(H_0\)</span>: the data come from a normal distribution. The test statistic (W) measures how well the ordered residuals match the expected pattern from a normal distribution, with <span class="math inline">\(W\)</span> ranging from 0 to 1 (higher values indicate better normality).</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Decision rule:</strong></p>
<ul>
<li>If p-value &lt; 0.05: Reject normality assumption (residuals are not normally distributed)</li>
<li>If p-value ‚â• 0.05: Cannot reject normality assumption (consistent with normality)</li>
</ul>
<p><strong>Important notes:</strong></p>
<ul>
<li>Very sensitive to sample size (may detect trivial deviations in large samples)</li>
<li>Should be used in conjunction with QQ plots, not as a replacement</li>
<li>Moderate violations are often acceptable, especially with n &gt; 30-50 (Central Limit Theorem)</li>
<li>Maximum sample size is 5000; use Kolmogorov-Smirnov for larger samples</li>
</ul>
</section>
<section id="alternative-normality-tests" class="level4">
<h4 class="anchored" data-anchor-id="alternative-normality-tests">Alternative Normality Tests</h4>
<p><strong>Kolmogorov-Smirnov Test:</strong></p>
<ul>
<li>More appropriate for larger samples (n &gt; 50)</li>
<li>Less powerful than Shapiro-Wilk but works with any sample size</li>
<li>Code: <code>ks.test(residuals(model), "pnorm", mean=0, sd=sd(residuals(model)))</code></li>
</ul>
<p><strong>Anderson-Darling Test:</strong></p>
<ul>
<li>Available in <code>nortest</code> package</li>
<li>Gives more weight to tails than Shapiro-Wilk</li>
<li>Good for detecting departures in the extremes</li>
<li>Code: <code>library(nortest); ad.test(residuals(model))</code></li>
</ul>
<hr>
</section>
</section>
<section id="tests-for-homoscedasticity" class="level3">
<h3 class="anchored" data-anchor-id="tests-for-homoscedasticity">Tests for Homoscedasticity</h3>
<section id="breusch-pagan-test" class="level4">
<h4 class="anchored" data-anchor-id="breusch-pagan-test">Breusch-Pagan Test</h4>
<p><strong>Purpose:</strong> Formal test for heteroscedasticity (non-constant variance).</p>
<p><strong>How it works:</strong> Regresses the squared residuals on the predictors to test whether variance is related to predictor values. Under <span class="math inline">\(H_0\)</span> (homoscedasticity), squared residuals should not be systematically related to predictors.</p>
<p>The test statistic follows a <span class="math inline">\(\chi^2\)</span> distribution with degrees of freedom equal to the number of predictors.</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Decision rule:</strong></p>
<ul>
<li>If p-value &lt; 0.05: Reject homoscedasticity (variance is not constant)</li>
<li>If p-value ‚â• 0.05: Cannot reject homoscedasticity (consistent with constant variance)</li>
</ul>
<p><strong>Solutions if violated:</strong></p>
<ul>
<li>Weighted least squares (WLS)</li>
<li>Robust standard errors (heteroscedasticity-consistent standard errors)</li>
<li>Variance-stabilizing transformations (log, square root)</li>
</ul>
</section>
<section id="white-test" class="level4">
<h4 class="anchored" data-anchor-id="white-test">White Test</h4>
<p><strong>Purpose:</strong> More general test for heteroscedasticity than Breusch-Pagan.</p>
<p><strong>How it works:</strong> Similar to Breusch-Pagan but includes cross-products and squared terms of predictors when regressing squared residuals. Tests for any form of heteroscedasticity, not just linear relationships between variance and predictors.</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skedastic)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">white_test</span>(model)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using lmtest:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model, <span class="sc">~</span> <span class="fu">fitted</span>(model) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">fitted</span>(model)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>When to use:</strong> When you suspect complex patterns of heteroscedasticity that Breusch-Pagan might miss, such as variance that changes non-linearly with predictors.</p>
<hr>
</section>
</section>
<section id="test-for-independence" class="level3">
<h3 class="anchored" data-anchor-id="test-for-independence">Test for Independence</h3>
<section id="durbin-watson-test" class="level4">
<h4 class="anchored" data-anchor-id="durbin-watson-test">Durbin-Watson Test</h4>
<p><strong>When to use:</strong> Primarily for time series data or any data with a natural ordering where adjacent observations might be correlated.</p>
<p><strong>Purpose:</strong> Tests for autocorrelation in residuals (correlation between consecutive residuals).</p>
<p><strong>How it works:</strong> Computes a test statistic based on the differences between consecutive residuals:</p>
<p><span class="math display">\[DW = \frac{\sum_{t=2}^{n}(e_t - e_{t-1})^2}{\sum_{t=1}^{n}e_t^2}\]</span></p>
<p>The DW statistic ranges from 0 to 4:</p>
<ul>
<li><strong>DW ‚âà 2</strong>: No autocorrelation (good)</li>
<li><strong>DW &lt; 2</strong>: Positive autocorrelation (consecutive residuals tend to have the same sign)</li>
<li><strong>DW &gt; 2</strong>: Negative autocorrelation (consecutive residuals tend to alternate signs)</li>
</ul>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>DW ‚âà 2: No autocorrelation (ideal)</li>
<li>DW &lt; 1.5 or &gt; 2.5: Potential concern</li>
<li>Check p-value for formal test of <span class="math inline">\(H_0\)</span>: no autocorrelation</li>
</ul>
<p><strong>Solutions if violated:</strong></p>
<ul>
<li>Add lagged variables to the model</li>
<li>Use time series methods (ARIMA, GLS)</li>
<li>Use robust standard errors that account for autocorrelation</li>
<li>Consider whether independence assumption is appropriate for your data</li>
</ul>
<p><strong>Important note:</strong> Only tests for first-order autocorrelation. For higher-order autocorrelation, examine ACF (autocorrelation function) plots or use Ljung-Box test.</p>
<hr>
</section>
</section>
<section id="test-for-linearity" class="level3">
<h3 class="anchored" data-anchor-id="test-for-linearity">Test for Linearity</h3>
<section id="reset-test-ramseys-regression-equation-specification-error-test" class="level4">
<h4 class="anchored" data-anchor-id="reset-test-ramseys-regression-equation-specification-error-test">RESET Test (Ramsey‚Äôs Regression Equation Specification Error Test)</h4>
<p><strong>Purpose:</strong> Tests for functional form misspecification - whether the linear form is adequate or if you need transformations/polynomial terms.</p>
<p><strong>How it works:</strong> Adds powers of fitted values (e.g., <span class="math inline">\(\hat{y}^2\)</span>, <span class="math inline">\(\hat{y}^3\)</span>, <span class="math inline">\(\hat{y}^4\)</span>) to the original model and tests whether they are jointly significant. If they are, the linear form is inadequate because higher-order terms improve the fit.</p>
<p>The logic: if the relationship is truly linear, powers of fitted values shouldn‚Äôt add predictive power.</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resettest</span>(model, <span class="at">power =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)  <span class="co"># Tests squared and cubed terms</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Decision rule:</strong></p>
<ul>
<li>If p-value &lt; 0.05: Linear form is inadequate; consider transformations or polynomial terms</li>
<li>If p-value ‚â• 0.05: Linear form appears adequate</li>
</ul>
<p><strong>Solutions if violated:</strong></p>
<ul>
<li>Transform the outcome variable (log, square root, Box-Cox)</li>
<li>Transform predictor variables</li>
<li>Add polynomial terms (X¬≤, X¬≥)</li>
<li>Consider non-linear modeling approaches</li>
</ul>
<hr>
</section>
</section>
<section id="tests-for-multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="tests-for-multicollinearity">Tests for Multicollinearity</h3>
<section id="variance-inflation-factor-vif" class="level4">
<h4 class="anchored" data-anchor-id="variance-inflation-factor-vif">Variance Inflation Factor (VIF)</h4>
<p><strong>When to use:</strong> Multiple regression with 2 or more predictors.</p>
<p><strong>Purpose:</strong> Detects multicollinearity (high correlation among predictors), which inflates standard errors and makes it difficult to isolate individual predictor effects.</p>
<p><strong>How it works:</strong> For each predictor, VIF measures how much the variance of its coefficient estimate is inflated due to correlation with other predictors:</p>
<p><span class="math display">\[VIF_j = \frac{1}{1 - R_j^2}\]</span></p>
<p>where <span class="math inline">\(R_j^2\)</span> is the R¬≤ from regressing predictor <span class="math inline">\(j\)</span> on all other predictors.</p>
<p><strong>Interpretation:</strong> VIF quantifies how much more variance the coefficient has compared to if predictors were uncorrelated. <span class="math inline">\(VIF = 1\)</span> means no correlation; <span class="math inline">\(VIF = 5\)</span> means variance is 5 times larger than if uncorrelated.</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Decision rules:</strong></p>
<ul>
<li><strong>VIF &lt; 5</strong>: Generally acceptable</li>
<li><strong>VIF 5-10</strong>: Moderate multicollinearity; investigate</li>
<li><strong>VIF &gt; 10</strong>: Serious multicollinearity; action needed</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Remove redundant predictors (keep the most important/interpretable)</li>
<li>Combine correlated predictors into a composite variable or index</li>
<li>Use ridge regression or principal components regression</li>
<li>Collect more data (multicollinearity is a data problem, not a model problem)</li>
</ul>
<p><strong>Important note:</strong> High VIF doesn‚Äôt bias coefficient estimates, but it inflates standard errors, making it harder to detect significant effects. Your model can still make good predictions with high VIF.</p>
<hr>
</section>
</section>
<section id="tests-for-influential-observations" class="level3">
<h3 class="anchored" data-anchor-id="tests-for-influential-observations">Tests for Influential Observations</h3>
<section id="cooks-distance-analysis" class="level4">
<h4 class="anchored" data-anchor-id="cooks-distance-analysis">Cook‚Äôs Distance Analysis</h4>
<p><strong>Purpose:</strong> Systematically identify influential observations using a quantitative threshold.</p>
<p><strong>How it works:</strong> Cook‚Äôs distance measures how much all fitted values change when observation <span class="math inline">\(i\)</span> is deleted:</p>
<p><span class="math display">\[D_i = \frac{(e_i^*)^2}{p} \times \frac{h_i}{1-h_i}\]</span></p>
<p>where <span class="math inline">\(e_i^*\)</span> is the standardized residual, <span class="math inline">\(h_i\)</span> is leverage, and <span class="math inline">\(p\)</span> is the number of parameters.</p>
<p><strong>R code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distance plot (automatically labeled)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract values for custom analysis</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>influential <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>highly_influential <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="fl">1.0</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View most influential observations</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(cooks_d, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Decision rules:</strong></p>
<ul>
<li><strong>D &lt; 0.5</strong>: Not influential</li>
<li><strong>D &gt; 0.5</strong>: Investigate this observation</li>
<li><strong>D &gt; 1.0</strong>: Highly influential; serious concern</li>
</ul>
<p><strong>What to do with influential points:</strong></p>
<ol type="1">
<li><strong>Check for errors:</strong> Data entry mistakes, measurement errors, coding errors</li>
<li><strong>Understand why:</strong> Does this observation represent a different population or process?</li>
<li><strong>Investigate context:</strong> Is this a meaningful outlier (e.g., major event) or noise?</li>
<li><strong>Report transparently:</strong> Show results with and without influential observations</li>
<li><strong>Never automatically delete:</strong> Deletion requires substantive justification, not just statistical criteria</li>
</ol>
<p><strong>Alternative influence measures:</strong></p>
<ul>
<li><strong>DFFITS</strong>: Similar to Cook‚Äôs D but focuses on change in individual fitted value</li>
<li><strong>DFBETAS</strong>: Change in each coefficient when observation is deleted</li>
<li><strong>Leverage</strong>: Hat values (<span class="math inline">\(h_i\)</span>); values &gt; <span class="math inline">\(2p/n\)</span> or <span class="math inline">\(3p/n\)</span> indicate high leverage</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="practical-workflow-for-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="practical-workflow-for-diagnostics">Practical Workflow for Diagnostics</h2>
<p>Follow this systematic approach for every regression analysis:</p>
<section id="always-start-with-visual-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="always-start-with-visual-diagnostics">1. Always Start with Visual Diagnostics</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all four diagnostic plots at once</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Examine each plot carefully:</p>
<ul>
<li>Plot 1: Check for patterns in residuals (linearity, homoscedasticity)</li>
<li>Plot 2: Check for deviations from the diagonal (normality)</li>
<li>Plot 3: Check for trends in spread (homoscedasticity)</li>
<li>Plot 4: Check for influential points (Cook‚Äôs distance)</li>
</ul>
</section>
<section id="run-key-quantitative-tests-optional" class="level3">
<h3 class="anchored" data-anchor-id="run-key-quantitative-tests-optional">2. Run Key Quantitative Tests (Optional)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Homoscedasticity</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Multicollinearity (if multiple predictors)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="investigate-issues-identified" class="level3">
<h3 class="anchored" data-anchor-id="investigate-issues-identified">3. Investigate Issues Identified</h3>
<p><strong>If linearity is violated:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try RESET test</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resettest</span>(model)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Consider transformations or polynomial terms</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>If heteroscedasticity is detected:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use robust standard errors</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">"HC3"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>If influential points are found:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Cook's distance</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify influential observations</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>influential_obs <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine these observations</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>data[influential_obs, ]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit model without them and compare</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>model_no_influential <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data[<span class="sc">-</span>influential_obs, ])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>If time series data:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Durbin-Watson test</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(model)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine residual plot over time</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(model), <span class="at">type =</span> <span class="st">"l"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="additional-tests-when-needed" class="level3">
<h3 class="anchored" data-anchor-id="additional-tests-when-needed">4. Additional Tests When Needed</h3>
<p>Use these only when initial diagnostics suggest specific problems:</p>
<ul>
<li><strong>RESET test</strong> if Residuals vs Fitted shows curves</li>
<li><strong>White test</strong> if heteroscedasticity pattern is complex</li>
<li><strong>Alternative normality tests</strong> if Shapiro-Wilk fails in large samples</li>
<li><strong>Cook‚Äôs distance analysis</strong> if Plot 4 suggests potential influential observations</li>
</ul>
<hr>
</section>
</section>
<section id="key-principles-to-remember" class="level2">
<h2 class="anchored" data-anchor-id="key-principles-to-remember">Key Principles to Remember</h2>
<ol type="1">
<li><p><strong>Visual diagnostics come first:</strong> Plots are more informative than p-values, especially in large samples where tests become overly sensitive.</p></li>
<li><p><strong>Statistical tests are supplements:</strong> Use quantitative tests to confirm what you see visually, not as a replacement for visual inspection.</p></li>
<li><p><strong>Context matters:</strong> Not all violations are equally serious. Linearity and independence are typically most critical; moderate violations of normality are often acceptable with reasonable sample sizes.</p></li>
<li><p><strong>Large samples are robust:</strong> With n &gt; 100, minor violations of normality and homoscedasticity have minimal practical impact due to the Central Limit Theorem and robustness of OLS.</p></li>
<li><p><strong>Investigate influential points, don‚Äôt automatically delete:</strong> Understand why they‚Äôre influential first. They may contain important information or indicate model misspecification.</p></li>
<li><p><strong>Report transparently:</strong> If you identify violations, acknowledge them and discuss their potential impact. If you exclude influential observations, report results both ways.</p></li>
<li><p><strong>Multiple diagnostics:</strong> Don‚Äôt rely on a single test or plot. A comprehensive assessment examines multiple perspectives on each assumption.</p></li>
<li><p><strong>Four assumptions, not five:</strong> Linear regression has four core distributional assumptions (linearity, independence, homoscedasticity, normality). Checking for influential observations is an important diagnostic practice, but it‚Äôs not a formal assumption of the model.</p></li>
</ol>
<p>Remember: Perfect adherence to all assumptions is rare in real data. The goal is to understand where and how assumptions are violated, assess the severity of violations, and make informed decisions about how to proceed with your analysis.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Claudius Gr√§bner-Radkowitsch</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>